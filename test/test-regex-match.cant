(import (use 'regex-match) regex-match regex-parse)

(to (test regex inputs)
  (let r (regex-parse regex))
  (format "~d\n~d\n" regex ("-" .repeat regex.count))
  (for each! ((string inputs))
    (let m (regex-match r string))
    (format "~d ~w\n" (if m "*" " ") string))
  (newline))

(print (regex-parse "."))

(test "." '("" "a" "ab"))
(test "X" '("hey" "X"))
(test "XY" '("hey" "X" "XY" "XYZ"))
(test "X|Y" '("hey" "X" "Y" "Z"))
(test "X*" '("" "X" "XX" "hey"))
(test "a(b|c)*d" '("ad" "ab" "abcd" "B"))
(test "a.*d" '("ad" "ab" "abcd" "B"))
(test "a[bc]*d" '("ad" "ab" "abcd" "B"))

; TODO more tests
